#pragma once

// NOLINT(namespace-envoy)

// Some sensible limits to protect against excess resource use
#define WEBSOCKET_HANDSHAKE_MAX_SIZE 4096
#define WEBSOCKET_CONTROL_FRAME_MAX_SIZE 256

/* Ref. RFC 6455 */

#define WEBSOCKET_GUID "258EAFA5-E914-47DA-95CA-C5AB0DC85B11"
/*
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-------+-+-------------+-------------------------------+
   |F|R|R|R| opcode|M| Payload len |    Extended payload length    |
   |I|S|S|S|  (4)  |A|     (7)     |             (16/64)           |
   |N|V|V|V|       |S|             |   (if payload len==126/127)   |
   | |1|2|3|       |K|             |                               |
   +-+-+-+-+-------+-+-------------+ - - - - - - - - - - - - - - - +
   |     Extended payload length continued, if payload len == 127  |
   + - - - - - - - - - - - - - - - +-------------------------------+
   |                               |Masking-key, if MASK set to 1  |
   +-------------------------------+-------------------------------+
   | Masking-key (continued)       |          Payload Data         |
   +-------------------------------- - - - - - - - - - - - - - - - +
   :                     Payload Data continued ... :
   + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +
   |                     Payload Data continued ... |
   +---------------------------------------------------------------+
*/

#define FIN_MASK 0x80
#define OPCODE_MASK 0x0F
#define MASK_MASK 0x80
#define PAYLOAD_LEN_MASK 0x7F

/*
 Opcode:  4 bits

    Defines the interpretation of the "Payload data". If an unknown
    opcode is received, the receiving endpoint MUST _Fail the
    WebSocket Connection_. The following values are defined.

    *  %x0 denotes a continuation frame

    *  %x1 denotes a text frame

    *  %x2 denotes a binary frame

    *  %x3-7 are reserved for further non-control frames

    *  %x8 denotes a connection close

    *  %x9 denotes a ping

    *  %xA denotes a pong

    *  %xB-F are reserved for further control frames
    */
#define OPCODE_CONTINUE 0
#define OPCODE_TEXT 1
#define OPCODE_BIN 2
#define OPCODE_CLOSE 8
#define OPCODE_PING 9
#define OPCODE_PONG 10
