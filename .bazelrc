# =====================================================================
# Envoy specific Bazel build/test options.
# =====================================================================

# Keep envoy.bazelrc up-to-date by run:
# curl -sSL https://raw.githubusercontent.com/envoyproxy/envoy-wasm/master/.bazelrc > envoy.bazelrc
import %workspace%/envoy.bazelrc
build --platform_mappings=
build:remote --remote_timeout=7200

# Enable path normalization by default.
# See: https://github.com/envoyproxy/envoy/pull/6519
build --define path_normalization_by_default=true

# release builds are optimized
build:release -c opt

# No debug info for release builds
build:release --define no_debug_info=1
build:release --linkopt=-Wl,--strip-all
build:release --features=-per_object_debug_info
build:release --fission=dbg

# Always use toolchain
build --crosstool_top=//bazel/toolchains:toolchain

build --define manual_stamp=manual_stamp

# Can't use tcmalloc as it does not compile with GCC 9 that we use for cross-compilation
# build --define tcmalloc=gperftools
